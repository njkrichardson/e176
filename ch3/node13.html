<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2019 (Released January 1, 2019) -->
<HTML lang="EN">
<HEAD>
<TITLE>Optimization with Equality Constraints</TITLE>
<META NAME="description" CONTENT="Optimization with Equality Constraints">
<META NAME="keywords" CONTENT="ch3">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2019">

<LINK REL="STYLESHEET" HREF="ch3.css">

<LINK REL="next" HREF="node14.html">
<LINK REL="previous" HREF="node12.html">
<LINK REL="next" HREF="node14.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node14.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node12.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node12.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A
 HREF="node14.html">Optimization with Inequality Constraints</A>
<B> Up:</B> <A
 HREF="node12.html">Constrained Optimization</A>
<B> Previous:</B> <A
 HREF="node12.html">Constrained Optimization</A>
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00031000000000000000">
Optimization with Equality Constraints</A>
</H2>

<P>
The optimization problems subject to equality constraints can be
generally formulated as:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\begin{array}{ll}
    \mbox{maximize/minimize} & f({\bf x})=f(x_1,\cdots,x_N) \\
    \mbox{subject to:} & h_i({\bf x})=h_i(x_1,\cdots,x_N)=0,
    \;\;\;\;\;(i=1,\cdots m)\\
  \end{array}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img647.svg"
 ALT="\begin{displaymath}\begin{array}{ll}
\mbox{maximize/minimize} &amp; f({\bf x})=f(x_1...
...=h_i(x_1,\cdots,x_N)=0,
\;\;\;\;\;(i=1,\cdots m)\\
\end{array}\end{displaymath}"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">169</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
where <!-- MATH
 $f({\bf x})$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img4.svg"
 ALT="$f({\bf x})$"></SPAN> is the objective function and <!-- MATH
 $h_i({\bf x})=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img648.svg"
 ALT="$h_i({\bf x})=0$"></SPAN>
is the ith constraint. Here <SPAN CLASS="MATH"><IMG STYLE="height: 2.32ex; vertical-align: -0.43ex; " SRC="img649.svg"
 ALT="$m\le N$"></SPAN>, as in general there does not
exist a solution that satisfies more than <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img54.svg"
 ALT="$N$"></SPAN> equations in the N-D 
space.

<P>
To visualize the problem, we first consider the special case with 
<SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img557.svg"
 ALT="$N=2$"></SPAN> and <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img650.svg"
 ALT="$m=1$"></SPAN>. In this case, both <!-- MATH
 $f({\bf x})$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img4.svg"
 ALT="$f({\bf x})$"></SPAN> and <!-- MATH
 $h({\bf x})$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img651.svg"
 ALT="$h({\bf x})$"></SPAN> 
are surfaces defined over the 2-D space spanned by <SPAN CLASS="MATH"><IMG STYLE="height: 1.63ex; vertical-align: -0.46ex; " SRC="img67.svg"
 ALT="$x_1$"></SPAN> and <SPAN CLASS="MATH"><IMG STYLE="height: 1.63ex; vertical-align: -0.46ex; " SRC="img65.svg"
 ALT="$x_2$"></SPAN>, 
and <!-- MATH
 $h({\bf x})=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img652.svg"
 ALT="$h({\bf x})=0$"></SPAN> is the contour line of <!-- MATH
 $h({\bf x})$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img651.svg"
 ALT="$h({\bf x})$"></SPAN> on the 2-D 
plane. The solution <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> must satisfy the following two 
conditions:

<UL>
<LI><SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> is on the contour line <!-- MATH
 $h({\bf x})=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img652.svg"
 ALT="$h({\bf x})=0$"></SPAN>;
</LI>
<LI><SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> is on the contour line <!-- MATH
 $f({\bf x})=d$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img653.svg"
 ALT="$f({\bf x})=d$"></SPAN> (for some 
  <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img654.svg"
 ALT="$d$"></SPAN> as shown in the figure), so that <!-- MATH
 $f({\bf x}^*)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img3.svg"
 ALT="$f({\bf x}^*)$"></SPAN> is an extremum,
  it does not increase/decrease in the neighborhood of <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN>
  along the contour line.
</LI>
</UL>
In other words, the two contours <!-- MATH
 $h({\bf x})=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img652.svg"
 ALT="$h({\bf x})=0$"></SPAN> and <!-- MATH
 $f({\bf x})=d$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img653.svg"
 ALT="$f({\bf x})=d$"></SPAN>
must coincide at <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN>, i.e., they must have the same tangents
and therefore parallel gradients (perpendicular to the tangents):
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\bigtriangledown_{\bf x}f({\bf x}^*)
  =\lambda^*\,\bigtriangledown_{\bf x} h({\bf x}^*)
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img655.svg"
 ALT="$\displaystyle \bigtriangledown_{\bf x}f({\bf x}^*)
=\lambda^*\,\bigtriangledown_{\bf x} h({\bf x}^*)$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">170</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
where the constant scaling factor <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img656.svg"
 ALT="$\lambda^*$"></SPAN> is positive if the
two gradients are in the same direction or negative if they are
in opposite directions. As here we are only interested in whether
the two curves coincide or not, the sign of <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img656.svg"
 ALT="$\lambda^*$"></SPAN> is of no
concern.

<P>
<IMG STYLE="" SRC="figures/Lagrange.png"
 ALT="Lagrange.png">

<P>
To find such a point <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN>, we first construct a new objective 
function, called the <EM>Lagrange function</EM> (or simply 
<EM>Lagrangian</EM>):
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
L({\bf x},\lambda)=f({\bf x})-\lambda\, h({\bf x})
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img657.svg"
 ALT="$\displaystyle L({\bf x},\lambda)=f({\bf x})-\lambda\, h({\bf x})$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">171</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
where <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img658.svg"
 ALT="$\lambda$"></SPAN> is the <EM>Lagrange multiplier</EM>, which can be 
either positive or negative (the sign in front of <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img658.svg"
 ALT="$\lambda$"></SPAN> can 
be either plus or minus), and then set the gradient of this 
objective function with respect to <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img658.svg"
 ALT="$\lambda$"></SPAN> as well as <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img8.svg"
 ALT="${\bf x}$"></SPAN> 
to zero:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\bigtriangledown_{{\bf x},\lambda} L({\bf x},\lambda)
  =\bigtriangledown_{{\bf x},\lambda} [ f({\bf x})-\lambda\, h({\bf x}) ]
  ={\bf0}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 2.79ex; vertical-align: -0.78ex; " SRC="img659.svg"
 ALT="$\displaystyle \bigtriangledown_{{\bf x},\lambda} L({\bf x},\lambda)
=\bigtriangledown_{{\bf x},\lambda} [ f({\bf x})-\lambda\, h({\bf x}) ]
={\bf0}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">172</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
This equation contains two parts:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\left\{\begin{array}{l}
  \bigtriangledown_{\bf x} f({\bf x})=\lambda\bigtriangledown_{\bf x} h({\bf x})\\
  \bigtriangledown_\lambda L({\bf x},\lambda)=\partial L({\bf x},\lambda)/\partial \lambda
  =-h({\bf x})=0
  \end{array}\right.
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.81ex; vertical-align: -2.32ex; " SRC="img660.svg"
 ALT="$\displaystyle \left\{\begin{array}{l}
\bigtriangledown_{\bf x} f({\bf x})=\lamb...
...=\partial L({\bf x},\lambda)/\partial \lambda
=-h({\bf x})=0
\end{array}\right.$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">173</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
This is an equation system containing <SPAN CLASS="MATH"><IMG STYLE="height: 2.09ex; vertical-align: -0.31ex; " SRC="img661.svg"
 ALT="$N+m=2+1=3$"></SPAN> equations for 
the same number of unknowns <!-- MATH
 $x_1,\,x_2,\,\lambda$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.32ex; vertical-align: -0.57ex; " SRC="img662.svg"
 ALT="$x_1,\,x_2,\,\lambda$"></SPAN>:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\frac{\partial f({\bf x})}{\partial x_i}
  =\lambda \frac{\partial h({\bf x})}{\partial x_i}\;\;\;(i=1,2),
  \;\;\;\;\;h({\bf x})=0
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.57ex; vertical-align: -2.06ex; " SRC="img663.svg"
 ALT="$\displaystyle \frac{\partial f({\bf x})}{\partial x_i}
=\lambda \frac{\partial h({\bf x})}{\partial x_i}\;\;\;(i=1,2),
\;\;\;\;\;h({\bf x})=0$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">174</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
The solution <!-- MATH
 ${\bf x}^*=[x_1^*,\,x_2^*]^T$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.79ex; vertical-align: -0.70ex; " SRC="img664.svg"
 ALT="${\bf x}^*=[x_1^*,\,x_2^*]^T$"></SPAN> and <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img656.svg"
 ALT="$\lambda^*$"></SPAN> (either
positive or negative) of this equation system happens to satisfy 
the desired relationships: (a) 
<!-- MATH
 $\bigtriangledown_{\bf x}f({\bf x}^*)=\lambda^*\bigtriangledown_{\bf x}h({\bf x}^*)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img665.svg"
 ALT="$\bigtriangledown_{\bf x}f({\bf x}^*)=\lambda^*\bigtriangledown_{\bf x}h({\bf x}^*)$"></SPAN>,
i.e., the two curves <!-- MATH
 $f({\bf x})=d$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img653.svg"
 ALT="$f({\bf x})=d$"></SPAN> and <!-- MATH
 $h({\bf x})=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img652.svg"
 ALT="$h({\bf x})=0$"></SPAN> do coincide 
at <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN>, and (b) <!-- MATH
 $h({\bf x}^*)=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img666.svg"
 ALT="$h({\bf x}^*)=0$"></SPAN>, i.e., <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> does 
indeed satisfy the equality constraints. 

<P>
Specially, consider the following two possible cases:

<UL>
<LI>If <!-- MATH
 $\lambda^*=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img667.svg"
 ALT="$\lambda^*=0$"></SPAN>, then 
  <!-- MATH
 $\bigtriangledown_{\bf x}f({\bf x}^*)=\lambda^*\bigtriangledown_{\bf x}h({\bf x}^*)=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img668.svg"
 ALT="$\bigtriangledown_{\bf x}f({\bf x}^*)=\lambda^*\bigtriangledown_{\bf x}h({\bf x}^*)=0$"></SPAN>, 
  indicating <!-- MATH
 $f({\bf x}^*)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img3.svg"
 ALT="$f({\bf x}^*)$"></SPAN> is an extremum independent of the constraint,
  i.e., the constraint <!-- MATH
 $h({\bf x})=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img652.svg"
 ALT="$h({\bf x})=0$"></SPAN> is inactive, and the optimization 
  is unconstrained. 
</LI>
<LI>If <!-- MATH
 $\lambda^*\ne 0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.32ex; vertical-align: -0.57ex; " SRC="img669.svg"
 ALT="$\lambda^*\ne 0$"></SPAN>, then <!-- MATH
 $\bigtriangledown_{\bf x}f({\bf x}^*)\ne 0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img670.svg"
 ALT="$\bigtriangledown_{\bf x}f({\bf x}^*)\ne 0$"></SPAN>
  (as in general <!-- MATH
 $\bigtriangledown_{\bf x}h({\bf x}^*)\ne{\bf0}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img671.svg"
 ALT="$\bigtriangledown_{\bf x}h({\bf x}^*)\ne{\bf0}$"></SPAN>),
  indicating <!-- MATH
 $f({\bf x}^*)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img3.svg"
 ALT="$f({\bf x}^*)$"></SPAN> is not an extremum without the constraint, 
  i.e., the constraint is active, and the optimization is indeed
  constrained.
</LI>
</UL>

<P>
The discussion above can be generalized from 2-D to an <SPAN CLASS="MATH"><IMG STYLE="height: 2.09ex; vertical-align: -0.21ex; " SRC="img672.svg"
 ALT="$N&gt;2$"></SPAN> dimensional
space, in which the optimal solution <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> is to be found to
extremize the objective <!-- MATH
 $f({\bf x})$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img4.svg"
 ALT="$f({\bf x})$"></SPAN> subject to <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img593.svg"
 ALT="$m$"></SPAN> equality 
constraints <!-- MATH
 $h_i({\bf x})=0\;(i=1,\cdots,m)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img673.svg"
 ALT="$h_i({\bf x})=0\;(i=1,\cdots,m)$"></SPAN>, each representing a 
contour surface in the N-D space. The solution <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> must 
satisfy the following two conditions:

<UL>
<LI><SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> is on all <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img593.svg"
 ALT="$m$"></SPAN> contour surfaces so that
  <!-- MATH
 $h_1({\bf x}^*)=\cdots=h_m({\bf x}^*)=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img674.svg"
 ALT="$h_1({\bf x}^*)=\cdots=h_m({\bf x}^*)=0$"></SPAN>, i.e., it is on the 
  intersection of these surfaces, a curve in the space (e.g.,
  the intersection of two surfaces in 3-D space is a curve);
</LI>
<LI><SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> is on a contour surface <!-- MATH
 $f({\bf x}^*)=d$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img675.svg"
 ALT="$f({\bf x}^*)=d$"></SPAN>
  (for some value <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img654.svg"
 ALT="$d$"></SPAN>) so that <!-- MATH
 $f({\bf x}^*)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img3.svg"
 ALT="$f({\bf x}^*)$"></SPAN> is an extremum,
  i.e., it does not increase or degrease in the neighborhood of 
  <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> along the curve.
</LI>
</UL>
Combining these conditions, we see that the intersection curve 
of the <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img593.svg"
 ALT="$m$"></SPAN> surfaces <!-- MATH
 $h_i({\bf x})=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img648.svg"
 ALT="$h_i({\bf x})=0$"></SPAN> must coincide with the contour
surface <!-- MATH
 $f({\bf x})=d$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img653.svg"
 ALT="$f({\bf x})=d$"></SPAN> at <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN>, i.e., the intersection of 
the tangent surfaces of <!-- MATH
 $h_i({\bf x})=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img648.svg"
 ALT="$h_i({\bf x})=0$"></SPAN> through <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> must
lie on the tangent surface of <!-- MATH
 $f({\bf x})=d$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img653.svg"
 ALT="$f({\bf x})=d$"></SPAN> at <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN>,
therefore the gradient <!-- MATH
 $\bigtriangledown f({\bf x}^*)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img676.svg"
 ALT="$\bigtriangledown f({\bf x}^*)$"></SPAN> must 
be a linear combination of the <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img593.svg"
 ALT="$m$"></SPAN> gradients 
<!-- MATH
 $\bigtriangledown h_i({\bf x}^*)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img677.svg"
 ALT="$\bigtriangledown h_i({\bf x}^*)$"></SPAN>:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\bigtriangledown_{\bf x}f({\bf x}^*)
=\sum_{i=1}^m \lambda_i^* \bigtriangledown_{\bf x} h_i({\bf x}^*)
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 7.20ex; vertical-align: -3.09ex; " SRC="img678.svg"
 ALT="$\displaystyle \bigtriangledown_{\bf x}f({\bf x}^*)
=\sum_{i=1}^m \lambda_i^* \bigtriangledown_{\bf x} h_i({\bf x}^*)$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">175</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>

<P>
<IMG STYLE="" SRC="figures/Lagrange1.png"
 ALT="Lagrange1.png">

<P>
To find such a solution <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> of the optimization problem, 
we first construct the Lagrange function:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
L({\bf x},{\bf\lambda})=f({\bf x})-\sum_{i=1}^m\lambda_i h_i({\bf x})
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 7.20ex; vertical-align: -3.09ex; " SRC="img679.svg"
 ALT="$\displaystyle L({\bf x},{\bf\lambda})=f({\bf x})-\sum_{i=1}^m\lambda_i h_i({\bf x})$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">176</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
where <!-- MATH
 ${\bf\lambda}=[\lambda_1,\cdots,\lambda_m]^T$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.79ex; vertical-align: -0.70ex; " SRC="img680.svg"
 ALT="${\bf\lambda}=[\lambda_1,\cdots,\lambda_m]^T$"></SPAN> is a vector
for <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img593.svg"
 ALT="$m$"></SPAN> <EM>Lagrange multipliers</EM>, and then set its gradient to 
zero: 
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\bigtriangledown_{{\bf x},{\bf\lambda}} L({\bf x},{\bf\lambda})
  =\bigtriangledown_{{\bf x},{\bf\lambda}}
  \left[ f({\bf x})-\sum_{i=1}^m \lambda_i h_i({\bf x}) \right]
  ={\bf0}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 7.43ex; vertical-align: -3.09ex; " SRC="img681.svg"
 ALT="$\displaystyle \bigtriangledown_{{\bf x},{\bf\lambda}} L({\bf x},{\bf\lambda})
=...
...\lambda}}
\left[ f({\bf x})-\sum_{i=1}^m \lambda_i h_i({\bf x}) \right]
={\bf0}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">177</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
to get the following two equation systems of <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img54.svg"
 ALT="$N$"></SPAN> and <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img593.svg"
 ALT="$m$"></SPAN> equations 
repectively:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\bigtriangledown_{\bf x} f({\bf x})
  =\sum_{i=1}^m \lambda_i \bigtriangledown_{\bf x} h_i({\bf x})
  \;\;\;\;\mbox{i.e.}\;\;\;\;
  \frac{\partial f({\bf x})}{\partial x_j}
  =\sum_{i=1}^m\lambda_i \frac{\partial h_i({\bf x})}{\partial x_j}
  \;\;\;(j=1,\cdots,N),
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 7.20ex; vertical-align: -3.09ex; " SRC="img682.svg"
 ALT="$\displaystyle \bigtriangledown_{\bf x} f({\bf x})
=\sum_{i=1}^m \lambda_i \bigtriangledown_{\bf x} h_i({\bf x})
\;\;\;\;$">i.e.<IMG STYLE="height: 7.20ex; vertical-align: -3.09ex; " SRC="img683.svg"
 ALT="$\displaystyle \;\;\;\;
\frac{\partial f({\bf x})}{\partial x_j}
=\sum_{i=1}^m\lambda_i \frac{\partial h_i({\bf x})}{\partial x_j}
\;\;\;(j=1,\cdots,N),$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">178</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
and
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\frac{\partial L({\bf x},{\bf\lambda})}{\partial \lambda_i}
  =h_i({\bf x})=0\;\;\;\;(i=1,\cdots,m)
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.57ex; vertical-align: -2.06ex; " SRC="img684.svg"
 ALT="$\displaystyle \frac{\partial L({\bf x},{\bf\lambda})}{\partial \lambda_i}
=h_i({\bf x})=0\;\;\;\;(i=1,\cdots,m)$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">179</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
The first set of <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img54.svg"
 ALT="$N$"></SPAN> equations indicates that the gradient 
<!-- MATH
 $\bigtriangledown_{\bf x}f({\bf x}^*)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img685.svg"
 ALT="$\bigtriangledown_{\bf x}f({\bf x}^*)$"></SPAN> at <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> is a 
linear combination of the <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img593.svg"
 ALT="$m$"></SPAN> gradients 
<!-- MATH
 $\bigtriangledown_{\bf x} h_i({\bf x}^*)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img686.svg"
 ALT="$\bigtriangledown_{\bf x} h_i({\bf x}^*)$"></SPAN>, while the second 
set of <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img593.svg"
 ALT="$m$"></SPAN> equations guarantees that <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> also satisfy
the <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img593.svg"
 ALT="$m$"></SPAN> equality constraints. Solving these equations we get 
the desired soluton <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> together with the Lagrange
multipliers <!-- MATH
 $\lambda_1,\cdots,\lambda_m$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.32ex; vertical-align: -0.57ex; " SRC="img687.svg"
 ALT="$\lambda_1,\cdots,\lambda_m$"></SPAN>. This is the 
<EM>Lagrange multiplier method</EM>.

<P>
Specially, if <!-- MATH
 $\lambda_i=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.32ex; vertical-align: -0.46ex; " SRC="img688.svg"
 ALT="$\lambda_i=0$"></SPAN>, then the ith constraint is not active. 
More specially if <!-- MATH
 $\lambda_i=0$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.32ex; vertical-align: -0.46ex; " SRC="img688.svg"
 ALT="$\lambda_i=0$"></SPAN> for all <!-- MATH
 $i=1,\cdots,m$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.32ex; vertical-align: -0.57ex; " SRC="img689.svg"
 ALT="$i=1,\cdots,m$"></SPAN>, then 
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\bigtriangledown_{\bf x} f({\bf x}^*)
  =\sum_{i=1}^m \lambda_i \bigtriangledown_{\bf x} h_i({\bf x})={\bf0}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 7.20ex; vertical-align: -3.09ex; " SRC="img690.svg"
 ALT="$\displaystyle \bigtriangledown_{\bf x} f({\bf x}^*)
=\sum_{i=1}^m \lambda_i \bigtriangledown_{\bf x} h_i({\bf x})={\bf0}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">180</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
indicating <!-- MATH
 $f({\bf x}^*)$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img3.svg"
 ALT="$f({\bf x}^*)$"></SPAN> is an extremum independent of any of
the constraints, i.e., <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> is an unconstrained solution, 
and the optimization problem is unconstrained.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node14.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node12.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node12.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A
 HREF="node14.html">Optimization with Inequality Constraints</A>
<B> Up:</B> <A
 HREF="node12.html">Constrained Optimization</A>
<B> Previous:</B> <A
 HREF="node12.html">Constrained Optimization</A></DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
