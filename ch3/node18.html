<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2019 (Released January 1, 2019) -->
<HTML lang="EN">
<HEAD>
<TITLE>Quadratic Programming (QP)</TITLE>
<META NAME="description" CONTENT="Quadratic Programming (QP)">
<META NAME="keywords" CONTENT="ch3">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2019">

<LINK REL="STYLESHEET" HREF="ch3.css">

<LINK REL="next" HREF="node19.html">
<LINK REL="previous" HREF="node17.html">
<LINK REL="next" HREF="node19.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node19.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node12.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node17.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A
 HREF="node19.html">Interior Point Methods</A>
<B> Up:</B> <A
 HREF="node12.html">Constrained Optimization</A>
<B> Previous:</B> <A
 HREF="node17.html">The Simplex Algorithm</A>
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00036000000000000000">
Quadratic Programming (QP)</A>
</H2>

<P>
A quadratic programming (QP) problem is to minimize a quadratic function 
subject to some equality and/or inequality constraints:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\begin{array}{ll}
    \mbox{minimize}    &
         f({\bf x})=\frac{1}{2}[{\bf x}-{\bf m}]^T{\bf Q}[{\bf x}-{\bf m}]
         =\frac{1}{2}{\bf x}^T{\bf Q}{\bf x}+{\bf c}^T{\bf x}+c
    \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\\
    \mbox{subject to:} & {\bf A}{\bf x}\le{\bf b}
  \end{array}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1004.svg"
 ALT="\begin{displaymath}\begin{array}{ll}
\mbox{minimize} &amp;
f({\bf x})=\frac{1}{2}[{\...
...\;\\
\mbox{subject to:} &amp; {\bf A}{\bf x}\le{\bf b}
\end{array}\end{displaymath}"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">231</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
where <!-- MATH
 ${\bf Q}={\bf Q}^T$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.79ex; vertical-align: -0.57ex; " SRC="img1005.svg"
 ALT="${\bf Q}={\bf Q}^T$"></SPAN> is a positive definite matrix, <!-- MATH
 ${\bf c}=-{\bf Qm},
\;c={\bf m}^T{\bf Q}{\bf m}/2$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.79ex; vertical-align: -0.70ex; " SRC="img1006.svg"
 ALT="${\bf c}=-{\bf Qm},
\;c={\bf m}^T{\bf Q}{\bf m}/2$"></SPAN>. Here the scalar constant <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img181.svg"
 ALT="$c$"></SPAN> can be dropped
as it does not play any role in the optimization.

<P>
We let <SPAN CLASS="MATH"><IMG STYLE="height: 2.32ex; vertical-align: -0.57ex; " SRC="img1007.svg"
 ALT="${\bf Q}$"></SPAN> be an <SPAN CLASS="MATH"><IMG STYLE="height: 2.09ex; vertical-align: -0.31ex; " SRC="img1008.svg"
 ALT="$N\times N$"></SPAN> matrix, <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img286.svg"
 ALT="${\bf A}$"></SPAN> an <SPAN CLASS="MATH"><IMG STYLE="height: 2.09ex; vertical-align: -0.31ex; " SRC="img1009.svg"
 ALT="$m\times N$"></SPAN> matrix,
and <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img941.svg"
 ALT="${\bf b}$"></SPAN> is an m-D vector, and <!-- MATH
 ${\bf x}^T{\bf Q}{\bf x}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.79ex; vertical-align: -0.57ex; " SRC="img1010.svg"
 ALT="${\bf x}^T{\bf Q}{\bf x}$"></SPAN> is a hyper 
elliptic paraboloid with the minimum at point <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img1011.svg"
 ALT="${\bf m}$"></SPAN> in the N-D space.

<P>
We first consider the special case where the QP problem is only subject to
equality constraints and we assume <SPAN CLASS="MATH"><IMG STYLE="height: 2.32ex; vertical-align: -0.43ex; " SRC="img649.svg"
 ALT="$m\le N$"></SPAN>, i.e., the number of constraints
is smaller than the number of unknowns in <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img8.svg"
 ALT="${\bf x}$"></SPAN>. Then the solution 
<SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img8.svg"
 ALT="${\bf x}$"></SPAN> has to satisfy <!-- MATH
 ${\bf Ax}-{\bf b}={\bf0}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.09ex; vertical-align: -0.31ex; " SRC="img1012.svg"
 ALT="${\bf Ax}-{\bf b}={\bf0}$"></SPAN>, i.e., it has to be on
<SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img593.svg"
 ALT="$m$"></SPAN> hyper planes in the N-D space.

<P>
The Lagrangian function of the QP problem is:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
L({\bf x},{\bf\lambda})=f({\bf x})+{\bf\lambda}^T({\bf Ax}-{\bf b})
  =\frac{1}{2}{\bf x}^T{\bf Q}{\bf x}+{\bf c}^T{\bf x}
  +{\bf\lambda}^T({\bf Ax}-{\bf b})
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 4.88ex; vertical-align: -1.71ex; " SRC="img1013.svg"
 ALT="$\displaystyle L({\bf x},{\bf\lambda})=f({\bf x})+{\bf\lambda}^T({\bf Ax}-{\bf b...
...1}{2}{\bf x}^T{\bf Q}{\bf x}+{\bf c}^T{\bf x}
+{\bf\lambda}^T({\bf Ax}-{\bf b})$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">232</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
and then set its derivatives with respect to both <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img8.svg"
 ALT="${\bf x}$"></SPAN> and
<!-- MATH
 ${\bf\lambda}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img731.svg"
 ALT="${\bf\lambda}$"></SPAN> to zero:
<BR>
<DIV CLASS="mathdisplay">
<!-- MATH
 \begin{eqnarray}
\bigtriangledown_{\bf x}L({\bf x},{\bf\lambda})
  &=&\bigtriangledown_{\bf x}f({\bf x})
  +\bigtriangledown_{\bf x}{\bf\lambda}^T({\bf A}{\bf x}-{\bf b})
  ={\bf Qx}+{\bf c}+{\bf A}^T{\bf\lambda}={\bf0}
  \nonumber\\
  \bigtriangledown_{\bf\lambda}L({\bf x},{\bf\lambda})
  &=&{\bf Ax}-{\bf b}={\bf0}
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img1014.svg"
 ALT="$\displaystyle \bigtriangledown_{\bf x}L({\bf x},{\bf\lambda})$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 1.16ex; vertical-align: -0.12ex; " SRC="img104.svg"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 3.02ex; vertical-align: -0.70ex; " SRC="img1015.svg"
 ALT="$\displaystyle \bigtriangledown_{\bf x}f({\bf x})
+\bigtriangledown_{\bf x}{\bf\lambda}^T({\bf A}{\bf x}-{\bf b})
={\bf Qx}+{\bf c}+{\bf A}^T{\bf\lambda}={\bf0}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
&nbsp;</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img1016.svg"
 ALT="$\displaystyle \bigtriangledown_{\bf\lambda}L({\bf x},{\bf\lambda})$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 1.16ex; vertical-align: -0.12ex; " SRC="img104.svg"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 2.09ex; vertical-align: -0.31ex; " SRC="img1017.svg"
 ALT="$\displaystyle {\bf Ax}-{\bf b}={\bf0}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">233</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

These two equations can be combined and expressed in matrix form as:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\left[\begin{array}{cc}{\bf Q}&{\bf A}^T\\{\bf A}&{\bf0}\end{array}\right]
  \left[\begin{array}{c}{\bf x}\\{\bf\lambda}\end{array}\right]
  =\left[\begin{array}{c}-{\bf c}\\{\bf b}\end{array}\right]
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.81ex; vertical-align: -2.32ex; " SRC="img1018.svg"
 ALT="$\displaystyle \left[\begin{array}{cc}{\bf Q}&amp;{\bf A}^T\\ {\bf A}&amp;{\bf0}\end{arr...
...}\end{array}\right]
=\left[\begin{array}{c}-{\bf c}\\ {\bf b}\end{array}\right]$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(<SPAN CLASS="arabic">234</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
Solving this system of <SPAN CLASS="MATH"><IMG STYLE="height: 2.09ex; vertical-align: -0.31ex; " SRC="img1019.svg"
 ALT="$m+N$"></SPAN> equations, we get both <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img20.svg"
 ALT="${\bf x}^*$"></SPAN> and
<!-- MATH
 ${\bf\lambda}^*$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img1020.svg"
 ALT="${\bf\lambda}^*$"></SPAN>.

<P>
<B>Example</B> 
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\mbox{Minimize:}\;\;\;\;\;\;f(x_1,x_2)=x^2_1+x^2_2
  =\frac{1}{2}[x_1,\;x_2]\left[\begin{array}{cc}2&0\\0&2\end{array}\right]
  \left[\begin{array}{c}x_1\\x_2\end{array}\right]
  =\frac{1}{2}{\bf x}^T{\bf Q}{\bf x}
  \nonumber
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH">Minimize:<IMG STYLE="height: 5.81ex; vertical-align: -2.32ex; " SRC="img1021.svg"
 ALT="$\displaystyle \;\;\;\;\;\;f(x_1,x_2)=x^2_1+x^2_2
=\frac{1}{2}[x_1,\;x_2]\left[\...
...\begin{array}{c}x_1\\ x_2\end{array}\right]
=\frac{1}{2}{\bf x}^T{\bf Q}{\bf x}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<P></P>

<P>
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\mbox{subject to:}\;\;\;\;\;\;
       {\bf Ax}=[1,\;1]\left[\begin{array}{c}x_1\\x_2\end{array}\right]
       =x_1+x_2={\bf b}=1
  \nonumber
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH">subject to:<IMG STYLE="height: 5.81ex; vertical-align: -2.32ex; " SRC="img1022.svg"
 ALT="$\displaystyle \;\;\;\;\;\;
{\bf Ax}=[1,\;1]\left[\begin{array}{c}x_1\\ x_2\end{array}\right]
=x_1+x_2={\bf b}=1$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<P></P>
where
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
{\bf Q}=\left[\begin{array}{cc}2&0\\0&2\end{array}\right],\;\;\;
  {\bf A}=[1,\;1],\;\;\;\;\;
  {\bf c}=\left[\begin{array}{c}0\\0\end{array}\right],\;\;\;\;\;
  {\bf b}=1;
  \nonumber
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.81ex; vertical-align: -2.32ex; " SRC="img1023.svg"
 ALT="$\displaystyle {\bf Q}=\left[\begin{array}{cc}2&amp;0\\ 0&amp;2\end{array}\right],\;\;\;...
...;\;
{\bf c}=\left[\begin{array}{c}0\\ 0\end{array}\right],\;\;\;\;\;
{\bf b}=1;$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<P></P>

<P>
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\left[\begin{array}{rrr}2&0&1\\0&2&1\\1&1&0\end{array}\right]
  \left[\begin{array}{r}x_1\\x_2\\\lambda\end{array}\right]
  =\left[\begin{array}{r}0\\0\\1\end{array}\right]
  \nonumber
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 8.59ex; vertical-align: -3.72ex; " SRC="img1024.svg"
 ALT="$\displaystyle \left[\begin{array}{rrr}2&amp;0&amp;1\\ 0&amp;2&amp;1\\ 1&amp;1&amp;0\end{array}\right]
\...
...\\ \lambda\end{array}\right]
=\left[\begin{array}{r}0\\ 0\\ 1\end{array}\right]$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<P></P>
Solving this equation we get the solution <!-- MATH
 $x^*_1=x^*_2=0.5$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.69ex; " SRC="img1025.svg"
 ALT="$x^*_1=x^*_2=0.5$"></SPAN> and
<!-- MATH
 $\lambda^*=-1$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.09ex; vertical-align: -0.31ex; " SRC="img1026.svg"
 ALT="$\lambda^*=-1$"></SPAN>, at which the function <!-- MATH
 $f(x^*_1,x^*_2)=0.5$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img1027.svg"
 ALT="$f(x^*_1,x^*_2)=0.5$"></SPAN> is 
minimized subject to <SPAN CLASS="MATH"><IMG STYLE="height: 2.09ex; vertical-align: -0.46ex; " SRC="img737.svg"
 ALT="$x_1+x_2=1$"></SPAN>.

<P>
If <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img1028.svg"
 ALT="$m=N$"></SPAN>, i.e., the number of equality constraints is the same
as the number of variables, then the variable <SPAN CLASS="MATH"><IMG STYLE="height: 1.39ex; vertical-align: -0.12ex; " SRC="img8.svg"
 ALT="${\bf x}$"></SPAN> is uniquely
determined by the linear system <!-- MATH
 ${\bf Ax}={\bf b}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img894.svg"
 ALT="${\bf Ax}={\bf b}$"></SPAN>, as the intersect
of <SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img1028.svg"
 ALT="$m=N$"></SPAN> hyper planes, independent of the objective function 
<!-- MATH
 $f({\bf x})$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img4.svg"
 ALT="$f({\bf x})$"></SPAN>. Further if <SPAN CLASS="MATH"><IMG STYLE="height: 2.09ex; vertical-align: -0.21ex; " SRC="img1029.svg"
 ALT="$m&gt;N$"></SPAN>, i.e., the system <!-- MATH
 ${\bf Ax}={\bf b}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.86ex; vertical-align: -0.12ex; " SRC="img894.svg"
 ALT="${\bf Ax}={\bf b}$"></SPAN> 
is over constrained, and its solution does not exist in general.
It is therefore more interesting to consider QP problems subject to
both equality and inequality constraints:
<P></P>
<DIV CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\begin{array}{ll}
    \mbox{minimize}    &
    f({\bf x})=\frac{1}{2}{\bf x}^T{\bf Q}{\bf x}+{\bf c}^T{\bf x}\\
    \;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\\
    \mbox{subject to:} & {\bf Ax}\le{\bf b}
  \end{array}
  \nonumber
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img1030.svg"
 ALT="\begin{displaymath}\begin{array}{ll}
\mbox{minimize} &amp;
f({\bf x})=\frac{1}{2}{\b...
...\;\;\;\;\\
\mbox{subject to:} &amp; {\bf Ax}\le{\bf b}
\end{array}\end{displaymath}"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
&nbsp;&nbsp;&nbsp;</TD></TR>
</TABLE></DIV>
<P></P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node19.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node12.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node17.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A
 HREF="node19.html">Interior Point Methods</A>
<B> Up:</B> <A
 HREF="node12.html">Constrained Optimization</A>
<B> Previous:</B> <A
 HREF="node17.html">The Simplex Algorithm</A></DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
